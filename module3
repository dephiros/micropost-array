'Calculate centroid of cell from the base coordinate of post. Modified CENTROID array to be
'double array with two elelemnt storing x and y coordinate of centroid
Sub centroidCal(xBase() As Variant, yBase() As Variant, centroid() As Double)
    Dim i As Integer, length As Integer
    centroid(0) = 0
    centroid(1) = 0
    length = UBound(xBase) - LBound(xBase) + 1
    For i = 0 To i < length - 1
        centroid(0) = centroid(0) + xBase(0)
        centroid(1) = centroid(0) + yBase(1)
        Next i
    centroid(0) = centroid(0) / length
    centroid(1) = centroid(1) / length
End Sub

'Given a POINT, return the region that the point belongs to.
Function assignRegion(point() As Double)
    
End Function

'Figure out the D-region. D-region composes of 1/3 numbers of of posts that are closest to the center.
Function dregion(x() As Variant, y() As Variant, centroid() As Double)
    Dim distance() As Double, ind() As Integer, result() As Integer
    ReDim distance(LBound(x) To UBound(x)) As Double, ind(LBound(x) To UBound(x)) As Integer
    Dim oneThird As Integer
    oneThird = Round((1 / 3) * (UBound(x) - LBound(x)))
    Debug.Print oneThird & " OneThird"
    Dim i As Integer
    For i = LBound(x) To UBound(x)
        Debug.Print i
        distance(i) = ((x(i, 1) - y(i, 1)) ^ 2 + (x(i, 1) - y(i, 1)) ^ 2) ^ (1 / 2)
        ind(i) = i
        Next i
    Call Module4.quicksort(distance, ind, LBound(distance), UBound(distance))
    ReDim result(LBound(ind) To oneThird - 1) As Integer
    For i = LBound(ind) To oneThird - 1
        result(i) = ind(i)
        Next i
    dregion = result
End Function

'Test centroid calculation
Sub testCentroid()
    Dim centroid(0 To 1) As Double
    Dim xBase() As Variant, yBase() As Variant
    xBase = Worksheets("result").Range("XB").Value
    yBase = Worksheets("result").Range("YB").Value
    Call centroidCal(xBase, yBase, centroid)
    Call dregion(xBase, yBase, centroid)
    Debug.Print (centroid(1))
    Debug.Print centroid(2)
End Sub
